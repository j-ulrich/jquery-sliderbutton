/*
 * jquery.simulate - simulate browser mouse and keyboard events
 * http://jqueryui.com
 * 
 * Copyright 2012 jQuery Foundation and other contributors
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
*/

(function(e){"use strict";function i(e){return r.test(Object.prototype.toString.call(e))}function s(e){for(var t=0;t<window.frames.length;t+=1)if(window.frames[t].document===e)return window.frames[t];return window}function o(t){var n,r;return t=e(t),i(t[0])?(r=t,n={left:0,top:0}):(r=e(t[0].ownerDocument||document),n=t.offset()),{x:n.left+t.outerWidth()/2-r.scrollLeft(),y:n.top+t.outerHeight()/2-r.scrollTop()}}var t=/^key/,n=/^(?:mouse|contextmenu)|click/,r=/\[object (?:HTML)?Document\]/;e.fn.simulate=function(t,n){return this.each(function(){new e.simulate(this,t,n)})},e.simulate=function(t,n,r){var i=e.camelCase("simulate-"+n);this.target=t,this.options=r||{},this[i]?this[i]():this.simulateEvent(t,n,this.options)},e.extend(e.simulate.prototype,{simulateEvent:function(e,t,n){var r=this.createEvent(t,n);this.dispatchEvent(e,t,r,n)},createEvent:function(e,r){if(t.test(e))return this.keyEvent(e,r);if(n.test(e))return this.mouseEvent(e,r)},mouseEvent:function(t,n){var r,o,u=i(this.target)?this.target:this.target.ownerDocument||document,a,f;return n=e.extend({bubbles:!0,cancelable:t!=="mousemove",view:s(u),detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:undefined},n),u.createEvent?(r=u.createEvent("MouseEvents"),r.initMouseEvent(t,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget||u.body.parentNode),r.pageX===0&&r.pageY===0&&Object.defineProperty&&(o=i(r.relatedTarget)?r.relatedTarget:r.relatedTarget.ownerDocument||document,a=o.documentElement,f=o.body,Object.defineProperty(r,"pageX",{get:function(){return n.clientX+(a&&a.scrollLeft||f&&f.scrollLeft||0)-(a&&a.clientLeft||f&&f.clientLeft||0)}}),Object.defineProperty(r,"pageY",{get:function(){return n.clientY+(a&&a.scrollTop||f&&f.scrollTop||0)-(a&&a.clientTop||f&&f.clientTop||0)}}))):u.createEventObject&&(r=u.createEventObject(),e.extend(r,n),r.button={0:1,1:4,2:2}[r.button]||r.button),r},keyEvent:function(t,n){var r,o;n=e.extend({bubbles:!0,cancelable:!0,view:s(o),ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:undefined},n),o=i(this.target)?this.target:this.target.ownerDocument||document;if(o.createEvent)try{r=o.createEvent("KeyEvents"),r.initKeyEvent(t,n.bubbles,n.cancelable,n.view,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.keyCode,n.charCode)}catch(u){r=o.createEvent("Events"),r.initEvent(t,n.bubbles,n.cancelable),e.extend(r,{view:n.view,ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,metaKey:n.metaKey,keyCode:n.keyCode,charCode:n.charCode})}else o.createEventObject&&(r=o.createEventObject(),e.extend(r,n));if(e.browser.msie||e.browser.opera)r.keyCode=n.charCode>0?n.charCode:n.keyCode,r.charCode=undefined;return r},dispatchEvent:function(e,t,n){e.dispatchEvent?e.dispatchEvent(n):e.fireEvent&&e.fireEvent("on"+t,n)},simulateFocus:function(){function i(){n=!0}var t,n=!1,r=e(this.target);r.bind("focus",i),r[0].focus(),n||(t=e.Event("focusin"),t.preventDefault(),r.trigger(t),r.triggerHandler("focus")),r.unbind("focus",i)},simulateBlur:function(){function i(){n=!0}var t,n=!1,r=e(this.target);r.bind("blur",i),r[0].blur(),setTimeout(function(){r[0].ownerDocument.activeElement===r[0]&&r[0].ownerDocument.body.focus(),n||(t=e.Event("focusout"),t.preventDefault(),r.trigger(t),r.triggerHandler("blur")),r.unbind("blur",i)},1)}}),e.extend(e.simulate.prototype,{simulateDrag:function(){var e=this.target,t=this.options,n=o(e),r=Math.floor(n.x),s=Math.floor(n.y),u=t.dx||0,a=t.dy||0,f={clientX:r,clientY:s},l=i(e)?e:e.ownerDocument||document;this.simulateEvent(e,"mousedown",f),f={clientX:r+1,clientY:s+1},this.simulateEvent(l,"mousemove",f),f={clientX:r+u,clientY:s+a},this.simulateEvent(l,"mousemove",f),this.simulateEvent(l,"mousemove",f),this.simulateEvent(e,"mouseup",f),this.simulateEvent(e,"click",f)}})})(jQuery);
/*! jquery-simulate-ext - v1.1.1 - 2012-10-11
 * https://github.com/j-ulrich/jquery-simulate-ext
 * Copyright (c) 2012 Jochen Ulrich; Licensed MIT
 */

(function(e){"use strict";var t=e.simulate.prototype.mouseEvent,n=/\[object (?:HTML)?Document\]/;e.simulate.prototype.mouseEvent=function(r,i){if(i.pageX||i.pageY){var s=n.test(Object.prototype.toString.call(this.target))?this.target:this.target.ownerDocument||document;i.clientX=(i.pageX||0)-e(s).scrollLeft(),i.clientY=(i.pageY||0)-e(s).scrollTop()}return t.apply(this,[r,i])}})(jQuery),function(e,t){"use strict";function i(t){return r.test(Object.prototype.toString.call(e(t)[0]))}function s(t,n){var r;if(e.isFunction(n)){for(r=0;r<t.length;r+=1)if(n(t[r]))return t[r];return null}for(r=0;r<t.length;r+=1)if(t[r])return t[r];return null}function o(t){var n;return t=e(t),i(t[0])?n={left:0,top:0}:n=t.offset(),{x:n.left+t.outerWidth()/2,y:n.top+t.outerHeight()/2}}function u(t,n,r){var s;i(n)?s=e(n):s=e(r||document);if(typeof t=="number"&&typeof n=="number")return{x:t-s.scrollLeft(),y:n-s.scrollTop()};if(typeof t=="object"&&t.pageX&&t.pageY)return{clientX:t.pageX-s.scrollLeft(),clientY:t.pageY-s.scrollTop()}}function a(t,n,r){var s;i(n)?s=n:s=r||document;if(!s.elementFromPoint)return null;var o=t,u=n;typeof t=="object"&&(t.clientX||t.clientY)&&(o=t.clientX||0,u=t.clientY||0);if(a.prototype.check){var f,l;(f=e(s).scrollTop())>0?(l=s.elementFromPoint(0,f+e(window).height()-1),l!==null&&l.tagName.toUpperCase()==="HTML"&&(l=null),a.prototype.nativeUsesRelative=l===null):(f=e(s).scrollLeft())>0&&(l=s.elementFromPoint(f+e(window).width()-1,0),l!==null&&l.tagName.toUpperCase()==="HTML"&&(l=null),a.prototype.nativeUsesRelative=l===null),a.prototype.check=f<=0}return a.prototype.nativeUsesRelative||(o+=e(s).scrollLeft(),u+=e(s).scrollTop()),s.elementFromPoint(o,u)}function f(t,n){var r=n||{};e(t).trigger({type:"simulate-drag"}),e.isFunction(r.callback)&&r.callback.apply(t)}function l(t,r,o,l,c){function w(){b.x+=g.x,b.y+=g.y;var e={pageX:b.x,pageY:b.y};if(p.shaky&&(p.shaky===!0||!isNaN(parseInt(p.shaky,10)))){var n=p.shaky===!0?1:parseInt(p.shaky,10);e.pageX+=Math.floor(Math.random()*(2*n+1)-n),e.pageY+=Math.floor(Math.random()*(2*n+1)-n)}var i=u(e,h),s=a(i,h)||r;t.simulateEvent(s,"mousemove",{pageX:Math.round(e.pageX),pageY:Math.round(e.pageY)})}function S(){var e=n()-E;if(e>=k)if(L<m)w(),L+=1,E=n(),setTimeout(S,k);else{var i={pageX:Math.round(o.x+l.dx),pageY:Math.round(o.y+l.dy)},s=u(i,h),p=a(s,h)||r;t.simulateEvent(p,"mousemove",i),f(r,c)}else setTimeout(S,k-e)}var h=s([r,r.ownerDocument],i)||document,p=c.interpolation,d=Math.sqrt(Math.pow(l.dx,2)+Math.pow(l.dy,2)),v,m,g;if(p.stepWidth){v=parseInt(p.stepWidth,10),m=Math.floor(d/v)-1;var y=v/d;g={x:l.dx*y,y:l.dy*y}}else m=parseInt(p.stepCount,10),v=d/(m+1),g={x:l.dx/(m+1),y:l.dy/(m+1)};var b=e.extend({},o),E;if(!p.stepDelay&&!p.duration||p.stepDelay<=0&&p.duration<=0){for(var x=0;x<m;x+=1)w();var T={pageX:Math.round(o.x+l.dx),pageY:Math.round(o.y+l.dy)},N=u(T,h),C=a(N,h)||r;t.simulateEvent(C,"mousemove",T),f(r,c)}else{var k=parseInt(p.stepDelay,10)||Math.ceil(parseInt(p.duration,10)/(m+1)),L=0;E=n(),setTimeout(S,k)}}e.fn.simulate=function(t,n){switch(t){case"drag":case"drop":case"drag-n-drop":var r=this.first();return new e.simulate(r[0],t,n),r;default:return this.each(function(){new e.simulate(this,t,n)})}};var n=Date.now||function(){return(new Date).getTime()},r=/\[object (?:HTML)?Document\]/;a.prototype.check=!0,a.prototype.nativeUsesRelative=!0,e.simulate.activeDrag=function(){return e.simulate._activeDrag?e.extend(!0,{},e.simulate._activeDrag):t},e.extend(e.simulate.prototype,{simulateDrag:function(){var n=this,r=n.target,c=e.extend({dx:0,dy:0,dragTarget:t,clickToDrag:!1,interpolation:{stepWidth:0,stepCount:0,stepDelay:0,duration:0,shaky:!1},callback:t},this.options),h,p=e.simulate._activeDrag&&e.simulate._activeDrag.dragElement===r;p?h=e.simulate._activeDrag.dragStart:h=o(r);var d=Math.round(h.x),v=Math.round(h.y),m={pageX:d,pageY:v},g,y;if(c.dragTarget){var b=o(c.dragTarget);g=Math.round(b.x-h.x),y=Math.round(b.y-h.y)}else g=c.dx||0,y=c.dy||0;p?(e.simulate._activeDrag.dragDistance.x+=g,e.simulate._activeDrag.dragDistance.y+=y,m={pageX:Math.round(d+e.simulate._activeDrag.dragDistance.x),pageY:Math.round(v+e.simulate._activeDrag.dragDistance.y)}):(e.simulate._activeDrag&&e(e.simulate._activeDrag.dragElement).simulate("drop"),n.simulateEvent(r,"mousedown",m),c.clickToDrag===!0&&(n.simulateEvent(r,"mouseup",m),n.simulateEvent(r,"click",m)),e(r).add(r.ownerDocument).one("mouseup",function(){e.simulate._activeDrag=t}),e.extend(e.simulate,{_activeDrag:{dragElement:r,dragStart:{x:d,y:v},dragDistance:{x:g,y:y}}}),m={pageX:Math.round(d+g),pageY:Math.round(v+y)});if(g!==0||y!==0)if(c.interpolation&&(c.interpolation.stepCount||c.interpolation.stepWidth))l(n,r,{x:d,y:v},{dx:g,dy:y},c);else{var w=s([r,r.ownerDocument],i)||document,E=u(m,w),S=a(E,w)||r;n.simulateEvent(S,"mousemove",m),f(r,c)}else f(r,c)},simulateDrop:function(){var n=this,r=this.target,f=e.simulate._activeDrag,l=e.extend({clickToDrop:!1,callback:t},n.options),c=!0,h=o(r),p=Math.round(h.x),d=Math.round(h.y),v={pageX:p,pageY:d},m=(f?s([f.dragElement,f.dragElement.ownerDocument],i):s([r,r.ownerDocument],i))||document,g=u(v,m),y=a(g,m);f&&(f.dragElement===r||i(r))&&(p=Math.round(f.dragStart.x+f.dragDistance.x),d=Math.round(f.dragStart.y+f.dragDistance.y),v={pageX:p,pageY:d},g=u(v,m),y=a(g,m),c=!1),y||(y=f?f.dragElement:r),c===!0&&n.simulateEvent(y,"mousemove",v),l.clickToDrop&&n.simulateEvent(y,"mousedown",v),this.simulateEvent(y,"mouseup",v),l.clickToDrop&&n.simulateEvent(y,"click",v),e.simulate._activeDrag=t,e(y).trigger({type:"simulate-drop"}),e.isFunction(l.callback)&&l.callback.apply(y)},simulateDragNDrop:function(){var n=this,r=this.target,i=e.extend({dragTarget:t,dropTarget:t},n.options),s=(i.dragTarget||i.dx||i.dy?i.dropTarget:r)||r;e(r).simulate("drag",e.extend({},i,{dragTarget:i.dragTarget||(i.dx||i.dy?t:i.dropTarget),callback:function(){e(s).simulate("drop",i)}}))}})}(jQuery),function(e){"use strict";e.extend(e.simulate.prototype,{simulateKeySequence:function(){function o(){e(t).trigger({type:"simulate-keySequence",sequence:r}),e.isFunction(n.callback)&&n.callback.apply(t,[{sequence:r}])}function u(){var t=f()-l;if(t>=n.delay){var c=a.exec(r);if(c!==null){var h=c[0];(i[h]||e.simulate.prototype.simulateKeySequence.defaults[h]||e.simulate.prototype.simulateKeySequence.defaults.simplechar)(s,h,n),setTimeout(u,n.delay)}else o();l=f()}else setTimeout(u,n.delay-t)}var t=this.target,n=e.extend({sequence:"",triggerKeyEvents:!0,delay:0,callback:undefined},this.options),r=n.sequence;n.delay=parseInt(n.delay,10);var i=e.extend({},n,e(t).data("simulate-keySequence")),s=e.data(t,"simulate-keySequence.selection");s||(s=bililiteRange(t).bounds("selection"),e.data(t,"simulate-keySequence.selection",s),e(t).bind("mouseup.simulate-keySequence",function(){e.data(t,"simulate-keySequence.selection").bounds("selection")}).bind("keyup.simulate-keySequence",function(n){n.which===9?e.data(t,"simulate-keySequence.selection").select():e.data(t,"simulate-keySequence.selection").bounds("selection")})),t.focus();if(typeof r=="undefined")return;r=r.replace(/\n/g,"{enter}");if(!n.delay||n.delay<=0)r.replace(/\{[^}]*\}|[^{]+/g,function(t){(i[t]||e.simulate.prototype.simulateKeySequence.defaults[t]||e.simulate.prototype.simulateKeySequence.defaults.simplechar)(s,t,n)}),o();else{var a=/\{[^}]*\}|[^{]/g,f=Date.now||function(){return(new Date).getTime()},l=f();u()}}}),e.extend(e.simulate.prototype.simulateKeySequence.prototype,{IEKeyCodeTable:{33:49,64:50,35:51,36:52,37:53,94:54,38:55,42:56,40:57,41:48,59:186,58:186,61:187,43:187,44:188,60:188,45:189,95:189,46:190,62:190,47:191,63:191,96:192,126:192,91:219,123:219,92:220,124:220,93:221,125:221,39:222,34:222},charToKeyCode:function(t){var n=e.simulate.prototype.simulateKeySequence.prototype.IEKeyCodeTable,r=t.charCodeAt(0);return r>=64&&r<=90||r>=48&&r<=57?r:r>=97&&r<=122?t.toUpperCase().charCodeAt(0):n[r]!==undefined?n[r]:r}}),e.simulate.prototype.simulateKeySequence.defaults={simplechar:function(t,n,r){t.text(n,"end");if(r.triggerKeyEvents)for(var i=0;i<n.length;i+=1){var s=n.charCodeAt(i),o=e.simulate.prototype.simulateKeySequence.prototype.charToKeyCode(n.charAt(i));e(t._el).simulate("keydown",{keyCode:o}),e(t._el).simulate("keypress",{keyCode:s,which:s,charCode:s}),e(t._el).simulate("keyup",{keyCode:o})}},"{{}":function(t,n,r){e.simulate.prototype.simulateKeySequence.defaults.simplechar(t,"{",r)},"{enter}":function(t,n,r){t.insertEOL(),t.select(),r.triggerKeyEvents===!0&&(e(t._el).simulate("keydown",{keyCode:13}),e(t._el).simulate("keypress",{keyCode:13,which:13,charCode:13}),e(t._el).simulate("keyup",{keyCode:13}))},"{backspace}":function(t,n,r){var i=t.bounds();i[0]===i[1]&&t.bounds([i[0]-1,i[0]]),t.text("","end"),r.triggerKeyEvents===!0&&(e(t._el).simulate("keydown",{keyCode:8}),e(t._el).simulate("keyup",{keyCode:8}))},"{del}":function(t,n,r){var i=t.bounds();i[0]===i[1]&&t.bounds([i[0],i[0]+1]),t.text("","end"),r.triggerKeyEvents===!0&&(e(t._el).simulate("keydown",{keyCode:46}),e(t._el).simulate("keyup",{keyCode:46}))},"{rightarrow}":function(t,n,r){var i=t.bounds();i[0]===i[1]&&(i[1]+=1),t.bounds([i[1],i[1]]).select(),r.triggerKeyEvents===!0&&(e(t._el).simulate("keydown",{keyCode:39}),e(t._el).simulate("keyup",{keyCode:39}))},"{leftarrow}":function(t,n,r){var i=t.bounds();i[0]===i[1]&&(i[0]-=1),t.bounds([i[0],i[0]]).select(),r.triggerKeyEvents===!0&&(e(t._el).simulate("keydown",{keyCode:37}),e(t._el).simulate("keyup",{keyCode:37}))},"{selectall}":function(e){e.bounds("all").select()}}}(jQuery),function(e,t){"use strict";var n={SHIFT:16,CONTROL:17,ALT:18,COMMAND:91};e.extend(e.simulate.prototype,{simulateKeyCombo:function(){var r=e(this.target),i=e.extend({combo:"",eventsOnly:!1},this.options),s={},o=i.combo,u=o.split(/(\+)/),a=!1,f=[],l;if(o.length===0)return;u=e.grep(u,function(e){return e!==""});for(l=0;l<u.length;l+=1){var c=u[l],h=c.toLowerCase();if(a){if(c!=="+")throw'Syntax error: expected "+"'}else{var p;switch(h){case"ctrl":case"alt":case"shift":case"meta":switch(h){case"ctrl":p=n.CONTROL;break;case"alt":p=n.ALT;break;case"shift":p=n.SHIFT;break;case"meta":p=n.COMMAND}s[h+"Key"]=!0,f.unshift(p),s.keyCode=p,r.simulate("keydown",s);break;default:if(c.length>1)throw'Syntax error: expecting "+" between each key';p=e.simulate.prototype.simulateKeySequence.prototype.charToKeyCode(c),f.unshift(p),s.keyCode=p,s.which=p,s.charCode=t,r.simulate("keydown",s),s.shiftKey&&(c=c.toUpperCase()),s.keyCode=c.charCodeAt(0),s.charCode=s.keyCode,s.which=s.keyCode,r.simulate("keypress",s),i.eventsOnly!==!0&&!s.ctrlKey&&!s.altKey&&!s.metaKey&&r.simulate("key-sequence",{sequence:c,triggerKeyEvents:!1})}}a=!a}if(!a)throw'Syntax error: expected key (trailing "+"?)';s.charCode=t;for(l=0;l<f.length;l+=1){s.keyCode=f[l],s.which=f[l];switch(s.keyCode){case n.ALT:s.altKey=!1;break;case n.SHIFT:s.shiftKey=!1;break;case n.CONTROL:s.ctrlKey=!1;break;case n.COMMAND:s.metaKey=!1;break;default:}r.simulate("keyup",s)}}})}(jQuery);
